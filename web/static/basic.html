<!DOCTYPE HTML>

<html>
    <head>
      
        <script type = "text/javascript">
            // Let us open a web socket
            var ws = new WebSocket("ws://192.168.31.90:8080");
            
            if ("WebSocket" in window) {
                ws.onopen = function() {
                };
                
                ws.onmessage = function (evt) { 
                    if (evt.data === null){
                    }
                    else if evt.data.startWith("redirect: "){
                        win = window.open(evt.data.slice(10), '_blank');
                        win.focus();
                    }
                    else{
                        document.getElementById("yao-display").value = evt.data;
                    };
                };
                
                ws.onclose = function() { 
                    // websocket is closed.
                    alert("Connection closed, Press `F5` to refresh this page."); 
                };
            } else {
          
                // The browser doesn't support WebSocket
                alert("WebSocket NOT supported by your Browser!");
            }

            function sendinstr(instr) {
                ws.send(instr);
            }

            function sendtext() {
                var obj = document.getElementById("yaoinstruct");
                var val = obj.value;
                sendinstr(val);
                obj.value = "";
            }

            function ontextchange() {
                //var e = window.event

                // If the user has pressed enter
                if (event.ctrlKey && (event.keyCode === 10 || event.keyCode === 13)) {
                    sendtext();
                    event.preventDefault();
                    return false;
                }
                else {
                    return true;
                }
            }

            function onqubitchange() {
                val = document.getElementById("input-nbits").value
                sendinstr("nbits("+val+")");
                return true;
            }

        </script>
		
    </head>
   
    <body>
        <h2>
        Yao QBIR
        </h2>
        <ul>
            <li>p: print variable</li>
            <li>ctrl-enter: send instruction</li>
        </ul>
        <p>
        Number of qubits: <input onchange="onqubitchange()" type="number" min="1" id="input-nbits" max="60">
        </p>
        <div>
        <textarea onkeypress="ontextchange()" style="width:500px" placeholder="send instruction here, `h` for help." id="yaoinstruct"></textarea>
        </div>

        <div>
        <button onclick="WebSocketTest()">test</button>
        <button onclick="sendtext()">send</button>
        </div>
        <div>
        <textarea disabled style="height:500px; width:500px" id="yao-display"></textarea>
        </div>
        <h4>
        Download
        </h4>
        <div>
        <button onclick="sendinstr('download_dense()')">dense matrix</button>
        <button onclick="sendinstr('download_coo()')">sparse matrix (COO format)</button>
        <button onclick="sendinstr('download_script()')">yaoscript</button>
        <button onclick="sendinstr('download_tensornetwork()')">tensor network</button>
        </div>
    </body>
</html>
